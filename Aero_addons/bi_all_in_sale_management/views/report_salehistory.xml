<?xml version="1.0" encoding="utf-8"?>
<odoo>
<template id="report_salehistory_document">
	<t t-call="web.external_layout">
		<t t-set="doc" t-value="doc.with_context({'lang':doc.partner_id.lang})" />
		<br/><br/>
		<div class="page">
			<div class="oe_structure"/>

		<div class="row">
                <div class="col-6">
                    <strong t-if="doc.partner_shipping_id == doc.partner_invoice_id">Invoicing and shipping address:</strong>
					<strong t-if="doc.partner_shipping_id != doc.partner_invoice_id">Invoicing address:</strong>
					<div t-field="doc.partner_invoice_id"
						t-options='{"widget": "contact", "fields": ["address", "name", "phone", "fax"], "no_marker": True, "phone_icons": True}'/>
						<p t-if="doc.partner_id.vat">VAT: <span t-field="doc.partner_id.vat"/></p>
					<div t-if="doc.partner_shipping_id != doc.partner_invoice_id" class="mt8">
						<strong>Shipping address:</strong>
						<div t-field="doc.partner_shipping_id"
							t-options='{"widget": "contact", "fields": ["address", "name", "phone", "fax"], "no_marker": True, "phone_icons": True}'/>
						<p t-if="doc.partner_id.vat">VAT: <span t-field="doc.partner_id.vat"/></p>
					</div>
					<br/>
                </div>
                <br/>
                <div class="col-6 text-right" style="font:15px lucida-console,sans-serif !important;" >
                	<strong>Customer Address:</strong>
					<div t-field="doc.partner_id"
						t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}' />
				</div>
        </div>
			<br/>
				<table class="table table-condensed">
					<thead>
						<tr>
							<th>No</th>
							<th>Customer Code(Description)</th>
							<th class="text-right">Old Price</th>
							<th class="text-right">New Price</th>
						</tr>
					</thead>
					<tbody>
					<t t-set="count" t-value="1"/>
						<t t-foreach="doc.sale_history_ids" t-as="record">
							
								<tr>
									<td><span t-esc="count"/></td>
									<td>
										<span t-field="record.product_id"/>
									</td>
									<td class="text-right">
										<span t-field="record.price_unit_old"/>
									</td>
									<td class="text-right">
										<span t-field="record.price_unit"/>
									</td>
									<t t-set="count" t-value="count + 1"/>
								</tr>
								
							</t>

					</tbody>
				</table>

				<t t-if="page_index &lt; page_size - 1" groups="sale.group_sale_layout">
					<p style="page-break-before:always;"> </p>
				</t>
				</div>
			</t>


			<p t-field="doc.note" />
			<p t-if="doc.payment_term_id.note">
				<span t-field="doc.payment_term_id.note"/>
			</p>
			<p id="fiscal_position_remark" t-if="doc.fiscal_position_id and doc.fiscal_position_id.note">
				<strong>Fiscal Position Remark:</strong>
				<span t-field="doc.fiscal_position_id.note"/>
			</p>
			<div class="oe_structure"/>
</template>


<template id="report_salehistory">
	<t t-call="web.html_container">
		<t t-foreach="docs" t-as="doc">
			<t t-call="bi_all_in_sale_management.report_salehistory_document" t-lang="doc.partner_id.lang"/>
		</t>
	</t>
</template>
</odoo>
